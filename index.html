<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Blood Link | Welcome</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* Variables and Reset */
        :root {
            --primary-color: #e53e3e; /* Blood Link Red */
            --primary-hover: #c53030; /* Darker Red */
            --bg-light: #f8f9fa;
            --bg-dark: #212529;
            --card-bg-light: #ffffff;
            --card-bg-dark: #343a40;
            --text-color-light: #343a40;
            --text-color-dark: #f8f9fa;
            --border-color-light: #e0e0e0;
            --border-color-dark: #495057;
            --shadow-light: rgba(0, 0, 0, 0.1);
            --shadow-dark: rgba(0, 0, 0, 0.5);
            --header-bg-light: #ffffff;
            --header-bg-dark: #2a2a2a;
        }

        body {
            font-family: 'Poppins', sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--bg-light);
            color: var(--text-color-light);
            transition: background-color 0.4s ease, color 0.4s ease;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* Dark Mode Styles */
        body.dark {
            --bg-light: #1a1a1a;
            --bg-dark: #0d0d0d;
            --card-bg-light: #2c2c2c;
            --card-bg-dark: #1f1f1f;
            --text-color-light: #e0e0e0;
            --text-color-dark: #f0f0f0;
            --border-color-light: #3a3a3a;
            --border-color-dark: #555;
            --shadow-light: rgba(0, 0, 0, 0.7);
            --shadow-dark: rgba(0, 0, 0, 0.9);
            --header-bg-light: #2c2c2c;
            --header-bg-dark: #1a1a1a;
        }

        /* Global Styles */
        *, *::before, *::after {
            box-sizing: border-box;
        }

        /* Header */
        header {
            width: 100%;
            background-color: var(--header-bg-light);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 15px 40px;
            box-shadow: 0 4px 12px var(--shadow-light);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        header .logo-container {
            display: flex;
            align-items: center;
        }

        header img.logo { /* Added .logo class */
            height: 90px; /* Adjusted logo size */
            margin-right: 15px;
            border-radius: 8px;
        }

        header h1.site-title { /* Added .site-title class */
            font-size: 28px;
            color: var(--text-color-light);
            margin: 0;
            font-weight: 700;
        }
        body.dark header h1.site-title {
            color: var(--text-color-dark);
        }

        nav {
            display: flex;
            align-items: center;
        }

        nav a {
            margin-left: 30px;
            text-decoration: none;
            color: var(--text-color-light);
            font-weight: 600;
            font-size: 16px;
            transition: color 0.3s ease;
            position: relative;
        }
          body.dark nav a {
            color: var(--text-color-dark);
        }

        nav a::after {
            content: '';
            position: absolute;
            width: 0;
            height: 2px;
            display: block;
            margin-top: 5px;
            right: 0;
            background: var(--primary-color);
            transition: width 0.3s ease;
        }

        nav a:hover::after, nav a.active-nav-link::after { /* Added .active-nav-link */
            width: 100%;
            left: 0;
            background: var(--primary-color);
        }
        nav a:hover, nav a.active-nav-link { /* Added .active-nav-link */
            color: var(--primary-color);
        }

        /* Main Content Area */
        main {
            width: 100%;
            max-width: 960px;
            padding: 40px 20px;
            margin: 40px auto;
            background-color: var(--card-bg-light);
            border-radius: 12px;
            box-shadow: 0 8px 25px var(--shadow-light);
            overflow: hidden;
            position: relative;
        }

        /* Section Transitions */
        section {
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.6s ease, transform 0.6s ease;
            padding: 20px;
            max-width: 700px;
            margin: 0 auto;
            display: none; /* Hidden by default */
        }

        section.active {
            opacity: 1;
            transform: translateY(0);
            display: block; /* Show active section */
        }

        h2.section-heading { /* Added .section-heading */
            text-align: center;
            margin-bottom: 35px;
            font-weight: 700;
            color: var(--primary-color);
            font-size: 32px;
        }

        h3, h4 {
            color: var(--text-color-light);
            margin-top: 30px;
            margin-bottom: 15px;
            font-weight: 600;
        }
        body.dark h3, body.dark h4 {
            color: var(--text-color-dark);
        }
        h3 { font-size: 24px; }
        h4 { font-size: 20px; }

        p {
            font-size: 16px;
            line-height: 1.7;
            margin-bottom: 15px;
            color: var(--text-color-light);
        }
        body.dark p {
            color: var(--text-color-dark);
        }


        ul.features-list { /* Added .features-list */
            list-style: none;
            padding-left: 0;
            margin-bottom: 30px;
        }

        ul.features-list li {
            background-color: var(--bg-light);
            padding: 15px 25px;
            margin-bottom: 12px;
            border-radius: 8px;
            box-shadow: 0 2px 8px var(--shadow-light);
            font-weight: 500;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            border-left: 4px solid var(--primary-color);
        }
        body.dark ul.features-list li {
            background-color: var(--card-bg-dark); /* Match card bg in dark */
        }
        ul.features-list li:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 12px var(--shadow-light);
        }

        /* Forms */
        form {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        input[type="text"],
        input[type="email"],
        input[type="password"] {
            background-color: var(--card-bg-light); /* Match main card bg */
            border: 1px solid var(--border-color-light);
            border-radius: 8px;
            padding: 14px 18px;
            font-size: 16px;
            color: var(--text-color-light);
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
            width: 100%;
        }
        body.dark input[type="text"],
        body.dark input[type="email"],
        body.dark input[type="password"] {
            background-color: var(--bg-dark); /* Darker input bg */
            color: var(--text-color-dark);
            border-color: var(--border-color-dark);
        }


        input[type="text"]:focus,
        input[type="email"]:focus,
        input[type="password"]:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(229, 62, 62, 0.25); /* Red focus ring */
        }

        input[type="submit"].form-submit-button { /* Added .form-submit-button */
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 15px;
            border-radius: 8px;
            font-size: 18px;
            cursor: pointer;
            font-weight: 700;
            transition: background-color 0.3s ease, transform 0.2s ease;
            width: 100%;
            margin-top: 10px;
        }

        input[type="submit"].form-submit-button:hover {
            background-color: var(--primary-hover);
            transform: translateY(-2px);
        }

        /* Dark Mode Toggle */
        .toggle-dark {
            position: relative;
            display: inline-block;
            width: 55px;
            height: 30px;
            border-radius: 30px;
            background-color: var(--border-color-light);
            cursor: pointer;
            transition: background-color 0.3s ease;
            vertical-align: middle;
            margin-left: 20px;
            border: none;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.2);
        }
        body.dark .toggle-dark {
            background-color: var(--border-color-dark);
        }

        .toggle-dark input {
            opacity: 0;
            width: 0;
            height: 0;
            position: absolute;
            left: -9999px;
        }

        .toggle-thumb {
            position: absolute;
            top: 3px;
            left: 3px;
            width: 24px;
            height: 24px;
            background-color: var(--primary-color);
            border-radius: 50%;
            transition: left 0.3s ease, background-color 0.3s ease, transform 0.2s ease;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        body.dark .toggle-dark input:checked + .toggle-thumb {
            background-color: #f0f0f0; /* Light thumb on dark checked */
        }


        .toggle-dark input:checked + .toggle-thumb {
            left: 28px;
            transform: rotate(360deg);
        }

        /* Google Sign-In Button */
        .google-signin-button {
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #4285F4; /* Google Blue */
            color: white;
            border: none;
            padding: 12px 15px;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            font-weight: 600;
            transition: background-color 0.3s ease, transform 0.2s ease;
            width: 100%;
            margin-top: 15px;
            text-decoration: none; /* For a tags */
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        .google-signin-button:hover {
            background-color: #357ae8;
            transform: translateY(-2px);
        }

        .google-signin-button img {
            margin-right: 10px;
            height: 20px;
            width: 20px;
        }

        .or-divider {
            text-align: center;
            margin: 20px 0;
            font-size: 14px;
            color: var(--text-color-light);
            position: relative;
        }

        .or-divider::before,
        .or-divider::after {
            content: '';
            position: absolute;
            top: 50%;
            width: 40%;
            height: 1px;
            background-color: var(--border-color-light);
        }

        .or-divider::before {
            left: 0;
        }

        .or-divider::after {
            right: 0;
        }
        body.dark .or-divider {
            color: var(--text-color-dark);
        }
        body.dark .or-divider::before,
        body.dark .or-divider::after {
            background-color: var(--border-color-dark);
        }


        /* Footer */
        footer {
            width: 100%;
            padding: 20px;
            text-align: center;
            background-color: var(--header-bg-light);
            color: var(--text-color-light);
            font-size: 14px;
            margin-top: auto;
            box-shadow: 0 -2px 8px var(--shadow-light);
            border-top: 1px solid var(--border-color-light);
        }
        body.dark footer {
            background-color: var(--header-bg-dark);
            color: var(--text-color-dark);
            border-top-color: var(--border-color-dark);
        }


        /* Responsive Design */
        @media (max-width: 768px) {
            header {
                flex-direction: column;
                padding: 15px 20px;
                text-align: center;
            }
            header .logo-container {
                margin-bottom: 15px;
            }
            nav {
                flex-wrap: wrap;
                justify-content: center;
            }
            nav a {
                margin: 0 15px 10px;
            }
            header h1.site-title {
                font-size: 24px;
            }
            main {
                margin: 20px auto;
                padding: 20px 15px;
            }
            h2.section-heading {
                font-size: 28px;
                margin-bottom: 25px;
            }
            ul.features-list li {
                padding: 12px 18px;
            }
        }

        @media (max-width: 480px) {
            header img.logo {
                height: 50px;
            }
            header h1.site-title {
                font-size: 20px;
            }
            nav a {
                margin: 0 10px 8px;
                font-size: 14px;
            }
            main {
                padding: 15px;
                margin: 15px;
            }
            h2.section-heading {
                font-size: 24px;
            }
            p, ul.features-list li, input {
                font-size: 15px;
            }
            input[type="submit"].form-submit-button {
                padding: 12px;
                font-size: 16px;
            }
        }
    </style>
</head>
<body>

<header>
    <div class="logo-container">
        <img src="logo.jpg" alt="Blood Link Logo" class="logo" />
        <h1 class="site-title">Blood Link</h1>
    </div>
    <nav>
        <a href="#" id="link-about" class="active-nav-link">About Us</a>
        <a href="#" id="link-login">Log In</a>
        <a href="#" id="link-signup">Sign Up</a>
        <label class="toggle-dark" for="darkToggle" aria-label="Toggle dark mode">
            <input type="checkbox" id="darkToggle" />
            <span class="toggle-thumb"></span>
        </label>
    </nav>
</header>

<main>
    <section id="about" class="active">
        <h2 class="section-heading">About Blood Link</h2>
        <h3><strong>🩸 Our Purpose:</strong></h3>
        <p>At <strong>Blood Link</strong>, we connect compassionate blood donors with those in critical need. Our platform is designed to streamline the process of finding and donating blood, making it easier for lifesavers and recipients to find each other quickly and efficiently.</p>

        <h3><strong>✨ Our Vision:</strong></h3>
        <p>We envision a world where no life is lost due to the unavailability of blood. Blood Link aims to build a strong, community-driven network that ensures timely access to safe blood for everyone, fostering a culture of voluntary blood donation.</p>

        <h3><strong>💡 Why Use Blood Link?</strong></h3>
        <ul class="features-list">
            <li><strong>Quick Donor Search:</strong> Easily find registered donors by blood group and location.</li>
            <li><strong>Simple Registration:</strong> Become a voluntary donor in a few simple steps.</li>
            <li><strong>Community Impact:</strong> Be part of a life-saving network and make a tangible difference.</li>
            <li><strong>Always Accessible:</strong> Our platform is here to help bridge the gap, 24/7.</li>
        </ul>
        <p>Join us in this vital mission. Whether you wish to donate or need to find a donor, Blood Link is your trusted partner. Your single act of kindness can save multiple lives. ❤️</p>
    </section>

    <section id="login" style="display:none;">
        <h2 class="section-heading">Log In to Your Account</h2>
        <form id="loginForm" autocomplete="off">
            <input type="email" id="loginEmail" placeholder="Email" required />
            <input type="password" id="loginPassword" placeholder="Password" required />
            <input type="submit" value="Log In" class="form-submit-button" />
        </form>
        <div class="or-divider">OR</div>
        <button id="googleSignInBtn" class="google-signin-button">
            <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" alt="Google logo" />
            Sign in with Google
        </button>
    </section>

    <section id="signup" style="display:none;">
        <h2 class="section-heading">Create Your Account</h2>
        <form id="signupForm" autocomplete="off">
            <input type="text" id="signupName" placeholder="Full Name" required />
            <input type="email" id="signupEmail" placeholder="Email" required />
            <input type="password" id="signupPassword" placeholder="Password (min. 6 characters)" required />
            <input type="submit" value="Sign Up" class="form-submit-button" />
        </form>
        <div class="or-divider">OR</div>
        <button id="googleSignUpBtn" class="google-signin-button">
            <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" alt="Google logo" />
            Sign up with Google
        </button>
    </section>
</main>

<footer>
    &copy; <span id="footerYear"></span> All rights reserved to Blood Link.
    <script>document.getElementById('footerYear').textContent = new Date().getFullYear();</script>
</footer>

<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script> <script>
    // --- Firebase Configuration ---
    const firebaseConfig = {
        apiKey: "AIzaSyCWjeZwrqCwe5NWN-Pdm5GPkp1_qJrCuSU",
        authDomain: "bloodlink-278a4.firebaseapp.com",
        databaseURL: "https://bloodlink-278a4-default-rtdb.firebaseio.com",
        projectId: "bloodlink-278a4",
        storageBucket: "bloodlink-278a4.firebasestorage.app",
        messagingSenderId: "88657445618",
        appId: "1:88657445618:web:90999baf48e9718ff5466b",
        measurementId: "G-XQGB69C3TP"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const database = firebase.database();
    const auth = firebase.auth(); // Initialize Firebase Auth
    const googleProvider = new firebase.auth.GoogleAuthProvider(); // Google Auth Provider

    // Section navigation
    const aboutSection = document.getElementById('about');
    const loginSection = document.getElementById('login');
    const signupSection = document.getElementById('signup');

    const navLinkAbout = document.getElementById('link-about');
    const navLinkLogin = document.getElementById('link-login');
    const navLinkSignup = document.getElementById('link-signup');
    const allNavLinks = [navLinkAbout, navLinkLogin, navLinkSignup];


    function showSection(sectionToShow, activeNavLink) {
        [aboutSection, loginSection, signupSection].forEach(s => {
            if (s) {
                s.style.display = 'none';
                s.classList.remove('active');
            }
        });
        allNavLinks.forEach(link => {
            if (link) link.classList.remove('active-nav-link');
        });

        if (sectionToShow) {
            sectionToShow.style.display = 'block';
            // Trigger reflow for animation
            void sectionToShow.offsetWidth;
            sectionToShow.classList.add('active');
        }
        if (activeNavLink) {
            activeNavLink.classList.add('active-nav-link');
        }
    }

    if (navLinkAbout) {
        navLinkAbout.addEventListener('click', (e) => {
            e.preventDefault();
            showSection(aboutSection, navLinkAbout);
        });
    }
    if (navLinkLogin) {
        navLinkLogin.addEventListener('click', (e) => {
            e.preventDefault();
            showSection(loginSection, navLinkLogin);
        });
    }
    if (navLinkSignup) {
        navLinkSignup.addEventListener('click', (e) => {
            e.preventDefault();
            showSection(signupSection, navLinkSignup);
        });
    }

    // Dark mode toggle
    const darkToggle = document.getElementById('darkToggle');

    function applyDarkMode(isDark) {
        if (isDark) {
            document.body.classList.add('dark');
            if (darkToggle) darkToggle.checked = true;
            localStorage.setItem('bloodLinkDarkMode', 'enabled'); // Unique key for this app
        } else {
            document.body.classList.remove('dark');
            if (darkToggle) darkToggle.checked = false;
            localStorage.removeItem('bloodLinkDarkMode');
        }
    }

    // Initialize toggle state from localStorage on page load
    applyDarkMode(localStorage.getItem('bloodLinkDarkMode') === 'enabled');

    if (darkToggle) {
        darkToggle.addEventListener('change', () => {
            applyDarkMode(darkToggle.checked);
        });
    }

    // Helper function for redirection after successful login/signup
    function handleAuthSuccess(user) {
        alert(`Welcome, ${user.displayName || user.email}! Redirecting to the Blood Link app...`);
        sessionStorage.setItem('bloodLinkLoggedInUser', JSON.stringify({ name: user.displayName || user.email, email: user.email }));
        window.location.href = 'homepage.html'; // Redirect to the main application
    }

    // Signup form logic (email/password)
    const signupForm = document.getElementById('signupForm');
    if (signupForm) {
        signupForm.addEventListener('submit', function(e) {
            e.preventDefault();
            const nameInput = document.getElementById('signupName');
            const emailInput = document.getElementById('signupEmail');
            const passwordInput = document.getElementById('signupPassword');

            if (!nameInput || !emailInput || !passwordInput) return;

            const name = nameInput.value.trim();
            const email = emailInput.value.trim().toLowerCase();
            const password = passwordInput.value; // In a real app, this would be hashed

            if (!name || !email || !password) {
                alert('All fields are required.');
                return;
            }
            if (password.length < 6) {
                alert('Password must be at least 6 characters long.');
                return;
            }

            // Using Firebase Authentication for email/password signup
            auth.createUserWithEmailAndPassword(email, password)
                .then((userCredential) => {
                    const user = userCredential.user;
                    // Save additional user info (like name) to Realtime Database
                    database.ref('users/' + user.uid).set({
                        name: name,
                        email: email,
                        createdAt: firebase.database.ServerValue.TIMESTAMP
                    })
                    .then(() => {
                        handleAuthSuccess({ displayName: name, email: email });
                        signupForm.reset();
                    })
                    .catch(error => {
                        console.error("Error saving user data to DB:", error);
                        alert('Account created, but failed to save additional info: ' + error.message);
                    });
                })
                .catch(error => {
                    console.error("Error creating user with email/password:", error);
                    alert('Failed to create account: ' + error.message);
                });
        });
    }

    // Login form logic (email/password)
    const loginForm = document.getElementById('loginForm');
    if (loginForm) {
        loginForm.addEventListener('submit', function(e) {
            e.preventDefault();
            const emailInput = document.getElementById('loginEmail');
            const passwordInput = document.getElementById('loginPassword');

            if (!emailInput || !passwordInput) return;

            const email = emailInput.value.trim().toLowerCase();
            const password = passwordInput.value;

            if (!email || !password) {
                alert('Email and password are required.');
                return;
            }

            // Using Firebase Authentication for email/password login
            auth.signInWithEmailAndPassword(email, password)
                .then((userCredential) => {
                    const user = userCredential.user;
                    // Fetch name from Realtime Database if available, otherwise use email
                    database.ref('users/' + user.uid).once('value')
                        .then(snapshot => {
                            const userData = snapshot.val();
                            const userName = userData && userData.name ? userData.name : user.email;
                            handleAuthSuccess({ displayName: userName, email: user.email });
                        })
                        .catch(error => {
                            console.error("Error fetching user data from DB:", error);
                            // Proceed with login even if name fetch fails
                            handleAuthSuccess({ displayName: user.email, email: user.email });
                        });
                })
                .catch(error => {
                    console.error("Error during login with email/password:", error);
                    alert('Login failed: ' + error.message);
                });
        });
    }

    // Google Sign-In for Login
    const googleSignInBtn = document.getElementById('googleSignInBtn');
    if (googleSignInBtn) {
        googleSignInBtn.addEventListener('click', () => {
            auth.signInWithPopup(googleProvider)
                .then((result) => {
                    const user = result.user;
                    // Check if user already exists in Realtime Database, if not, add them
                    database.ref('users/' + user.uid).once('value')
                        .then(snapshot => {
                            if (!snapshot.exists()) {
                                database.ref('users/' + user.uid).set({
                                    name: user.displayName,
                                    email: user.email,
                                    createdAt: firebase.database.ServerValue.TIMESTAMP
                                });
                            }
                            handleAuthSuccess(user);
                        });
                })
                .catch((error) => {
                    console.error("Google Sign-In Error:", error);
                    alert('Google Sign-In failed: ' + error.message);
                });
        });
    }

    // Google Sign-Up (same as login, as Firebase handles creation if user doesn't exist)
    const googleSignUpBtn = document.getElementById('googleSignUpBtn');
    if (googleSignUpBtn) {
        googleSignUpBtn.addEventListener('click', () => {
            auth.signInWithPopup(googleProvider)
                .then((result) => {
                    const user = result.user;
                    // Check if user already exists in Realtime Database, if not, add them
                    database.ref('users/' + user.uid).once('value')
                        .then(snapshot => {
                            if (!snapshot.exists()) {
                                database.ref('users/' + user.uid).set({
                                    name: user.displayName,
                                    email: user.email,
                                    createdAt: firebase.database.ServerValue.TIMESTAMP
                                });
                            }
                            handleAuthSuccess(user);
                        });
                })
                .catch((error) => {
                    console.error("Google Sign-Up Error:", error);
                    alert('Google Sign-Up failed: ' + error.message);
                });
        });
    }

    // Show about section on load by default
    showSection(aboutSection, navLinkAbout);
</script>
</body>
</html>
